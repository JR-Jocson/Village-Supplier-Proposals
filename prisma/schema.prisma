// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Project {
  id             String       @id @default(uuid())
  kibbutzName    String       // Name of the kibbutz/settlement
  submitterName  String       // Name of the person who submitted
  submitterEmail String       // Email of the submitter
  submitterPhone String       // Phone number of the submitter
  invoicePrice   Float?       // Detected price from invoice
  status         String       @default("draft") // draft, submitted, reviewed, etc.
  files          ProjectFile[]
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
}

model ProjectFile {
  id          String   @id @default(uuid())
  projectId   String
  project     Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  fileName    String   // Original file name
  filePath    String   // Path in Supabase Storage bucket
  fileType    String   // invoice, proposal, tender
  fileSize    Int      // File size in bytes
  mimeType    String   // MIME type (e.g., application/pdf)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([projectId])
}

